---
name: HITL_Approver
description: Human-in-the-Loop Approver. Detects sensitive actions (payments, LinkedIn posts, emails to unknown contacts, amounts >$50) and routes to Pending_Approval/. Orchestrator watches /Approved for execution. Logs everything in /Logs/.
version: 1.0.0
author: Personal AI Employee
capabilities:
  - sensitivity_detection
  - approval_routing
  - pending_file_creation
  - approval_monitoring
  - execution_trigger
tools_required:
  - email-mcp
  - browser-mcp (for LinkedIn)
  - calendar-mcp (optional)
when_to_use:
  - Any action requires human approval before execution
  - Sensitive content detected (financial, legal, HR)
  - New external contacts
  - LinkedIn posts
  - Payments or financial transactions
when_not_to_use:
  - Non-sensitive routine tasks
  - Pre-approved automated actions
  - Emergency situations (use emergency protocol)
output_format:
  - Pending_Approval/[TYPE]_YYYYMMDD_HHMMSS.md
  - Logs/approval_YYYYMMDD.jsonl
sensitivity_thresholds:
  - financial_amount: $50 (any mention triggers approval)
  - linkedin_post: always requires approval
  - new_contact: unknown email addresses trigger approval
  - payment: any payment mention triggers approval
  - confidential: keywords trigger approval
---

# HITL Approver Skill

## Overview

This skill implements **Human-in-the-Loop (HITL)** approval workflow for sensitive actions. It intercepts actions before execution, evaluates sensitivity, and routes to appropriate approval queues.

## Sensitivity Detection Rules

### ALWAYS Route to Pending_Approval

| Trigger | Pattern | Threshold |
|---------|---------|-----------|
| **Financial** | `\$[0-9]+`, `$50+` | >$50 |
| **Payment** | `payment`, `pay`, `transfer`, `invoice` | Any |
| **LinkedIn Post** | `linkedin`, `post`, `publish` | Always |
| **New Contact** | Email not in contacts | First time |
| **Confidential** | `confidential`, `NDA`, `proprietary` | Any |
| **Legal** | `contract`, `agreement`, `legal` | Any |
| **HR Sensitive** | `salary`, `termination`, `hire` | Any |

## Workflow

```
┌─────────────────┐
│ Action Request  │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ Sensitivity     │
│ Check           │
└────────┬────────┘
         │
    ┌────┴────┐
    │         │
    ▼         ▼
┌───────┐ ┌──────────┐
│ Safe  │ │ Sensitive│
└───┬───┘ └────┬─────┘
    │          │
    ▼          ▼
┌──────────┐ ┌────────────────┐
│ Execute  │ │ Pending_Approval│
│ Directly │ │ /TYPE_*.md     │
└──────────┘ └────────┬───────┘
                      │
                      ▼
               ┌──────────────┐
               │ Human Review │
               └──────┬───────┘
                      │
         ┌────────────┼────────────┐
         │            │            │
         ▼            ▼            ▼
    ┌────────┐  ┌──────────┐  ┌─────────┐
    │Approve │  │  Reject  │  │ Modify  │
    └───┬────┘  └────┬─────┘  └────┬────┘
        │           │              │
        ▼           ▼              ▼
    ┌────────┐  ┌──────────┐  ┌─────────┐
    │Approved│  │ Archived │  │Re-submit│
    └───┬────┘  └──────────┘  └─────────┘
        │
        ▼
    ┌────────┐
    │Execute │
    │via MCP │
    └────────┘
```

## File Structure

```
Pending_Approval/
├── EMAIL_20260217_143022.md      # Email awaiting approval
├── LINKEDIN_POST_20260217_145030.md  # LinkedIn post
├── PAYMENT_20260217_150000.md    # Payment request
└── GENERAL_20260217_151500.md    # General sensitive task

Approved/
└── [TYPE]_*.md                   # Approved actions ready for execution

Logs/
├── approval_20260217.jsonl       # Approval activity log
└── activity_20260217.jsonl       # General activity log
```

## Approval File Structure

```markdown
---
approval_id: APPROVAL_YYYYMMDD_HHMMSS
type: email|linkedin|payment|general
created: ISO_TIMESTAMP
status: PENDING
priority: high|medium|low
sensitivity_flags: [flag1, flag2]
---

# Approval Required: [Action Type]

## Summary
Brief description of what needs approval

## Sensitivity Detection
| Flag | Status | Details |
|------|--------|---------|
| Financial >$50 | ⚠️ Yes | $500 mentioned |
| New Contact | ✅ No | Known contact |
| Confidential | ✅ No | No sensitive keywords |

## Action Details
[Full details of the proposed action]

## Risk Assessment
- **Risk Level:** Low/Medium/High
- **Impact:** Description of potential impact
- **Reversibility:** Can this be undone?

## Approval Decision

- [ ] **APPROVE** - Move to Approved/ for execution
- [ ] **REJECT** - Archive with reason
- [ ] **MODIFY** - Request changes and re-submit

### Decision Notes
_Reason for approval/rejection_

---
*Generated by HITL Approver | Personal AI Employee*
```

## Orchestrator Integration

The orchestrator watches `/Approved` folder:

```python
# When file appears in Approved/:
1. Parse approval file
2. Extract action details
3. Trigger appropriate MCP server
4. Log execution
5. Move to Done/
```

## Logging

All approval activities logged to `Logs/approval_YYYYMMDD.jsonl`:

```json
{
  "timestamp": "2026-02-17T14:30:22",
  "event": "approval_requested",
  "approval_id": "APPROVAL_20260217_143022",
  "type": "email",
  "sensitivity_flags": ["new_contact"],
  "status": "pending"
}
```

## Examples

### Example 1: Email to New Contact

**Detected:** Email to unknown@company.com

**Action:** Create `Pending_Approval/EMAIL_20260217_143022.md`

**Wait for:** Human moves to Approved/ or rejects

### Example 2: LinkedIn Post

**Detected:** User wants to post about product launch

**Action:** Create `Pending_Approval/LINKEDIN_POST_20260217_145030.md`

**Wait for:** Human review and approval

### Example 3: Payment Request

**Detected:** "Pay $500 for software license"

**Action:** Create `Pending_Approval/PAYMENT_20260217_150000.md`

**Wait for:** Human financial approval

## Quality Checklist

Before routing to approval:
- [ ] Sensitivity flags correctly identified
- [ ] All relevant details included
- [ ] Risk assessment completed
- [ ] Clear approval decision options
- [ ] Logged to approval log

---

*HITL Approver Skill v1.0 | Personal AI Employee*
